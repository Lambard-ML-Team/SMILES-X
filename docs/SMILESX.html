

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>SMILESX package &#8212; SMILES-X 2.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'SMILESX';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SMILESX" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">SMILES-X 2.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Welcome to SMILES-X’s documentation!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="modules.html">SMILESX</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">SMILESX package</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Lambard-ML-Team/SMILES-X" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Lambard-ML-Team/SMILES-X/blob/main/../SMILESX/SMILESX.rst?plain=1" target="_blank"
   class="btn btn-sm btn-source-file-button dropdown-item"
   title="Show source"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">Show source</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Lambard-ML-Team/SMILES-X/issues/new?title=Issue%20on%20page%20%2FSMILESX.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/SMILESX.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SMILESX package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.augm">SMILESX.augm module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.augmentation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.generate_smiles"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.generate_smiles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.rotate_atoms"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.rotate_atoms()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.bayopt">SMILESX.bayopt module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.bayopt.bayopt_run"><code class="docutils literal notranslate"><span class="pre">SMILESX.bayopt.bayopt_run()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.embeddingvis">SMILESX.embeddingvis module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.embeddingvis.Embedding_Vis"><code class="docutils literal notranslate"><span class="pre">SMILESX.embeddingvis.Embedding_Vis()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.generation">SMILESX.generation module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.data_name"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.data_name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.g_run_number"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.g_run_number</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gen_augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gen_augmentation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_augmentation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_use_n_folds"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_use_n_folds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_use_n_runs"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_use_n_runs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.indir"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.indir</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.outdir"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.outdir</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.n_gpus"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.n_gpus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gpus_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gpus_list</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gpus_debug"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gpus_debug</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.prop_names_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.prop_names_list</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.display"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.display()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.generate"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.generate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.generative_main">SMILESX.generative_main module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generative_main.generative_main"><code class="docutils literal notranslate"><span class="pre">SMILESX.generative_main.generative_main()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.genutils">SMILESX.genutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.join_tokens"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.join_tokens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.normalize"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.normalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.p_to_one"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.p_to_one()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.remove_from_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.remove_from_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.remove_schar"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.remove_schar()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.sample"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.softmax"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.softmax()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.t_cdf"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.t_cdf()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.geomopt">SMILESX.geomopt module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_prescore"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_prescore()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_score"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_search"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_search()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.inference">SMILESX.inference module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.inference.infer"><code class="docutils literal notranslate"><span class="pre">SMILESX.inference.infer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.interpret">SMILESX.interpret module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.interpret.get_similarity_map_from_weights"><code class="docutils literal notranslate"><span class="pre">SMILESX.interpret.get_similarity_map_from_weights()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.interpret.interpret"><code class="docutils literal notranslate"><span class="pre">SMILESX.interpret.interpret()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.loadmodel">SMILESX.loadmodel module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.loadmodel.LoadModel"><code class="docutils literal notranslate"><span class="pre">SMILESX.loadmodel.LoadModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.main">SMILESX.main module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.main.main"><code class="docutils literal notranslate"><span class="pre">SMILESX.main.main()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.model">SMILESX.model module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.LSTMAttModel"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.LSTMAttModel</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.LSTMAttModel.create"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.LSTMAttModel.create()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.build"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.call"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.compute_output_shape()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.create_masks"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.create_masks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.create_padding_mask"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.create_padding_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.get_config"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.get_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.token">SMILESX.token module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.extract_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.extract_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_inttotoken"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_inttotoken()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_tokens"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_tokens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_tokentoint"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_tokentoint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.int_vec_encode"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.int_vec_encode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.onehot"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.onehot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.save_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.save_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.smiles_tokenizer"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.smiles_tokenizer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.trainutils">SMILESX.trainutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CosineAnneal"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CosineAnneal</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN.evaluation"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN.evaluation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN.on_evaluation_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN.on_evaluation_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.clr"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.clr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.on_batch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.on_train_begin"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.DataSequence"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.DataSequence</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.DataSequence.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.DataSequence.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LM_DataSequence"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LM_DataSequence</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LM_DataSequence.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LM_DataSequence.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback.on_epoch_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.StepDecay"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.StepDecay</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.seq_trunc"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.seq_trunc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.utils">SMILESX.utils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.StopExecution"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.StopExecution</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.log_setup"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.log_setup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.mean_result"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.mean_result()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.rand_split"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.rand_split()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.robust_scaler"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.robust_scaler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.set_gpuoptions"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.set_gpuoptions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.smiles_concat"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.smiles_concat()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.visutils">SMILESX.visutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.classification_metrics"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.classification_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.error_format"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.error_format()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.learning_curve"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.learning_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.lm_metric_curve"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.lm_metric_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.output_prec"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.output_prec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.plot_fit"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.plot_fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.print_stats"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.print_stats()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_classification_metrics"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_classification_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_mae"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_mae()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_r2"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_r2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_rmse"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_rmse()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX">Module contents</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="smilesx-package">
<h1>SMILESX package<a class="headerlink" href="#smilesx-package" title="Permalink to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
</section>
<section id="module-SMILESX.augm">
<span id="smilesx-augm-module"></span><h2>SMILESX.augm module<a class="headerlink" href="#module-SMILESX.augm" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.augm.augmentation">
<span class="sig-prename descclassname"><span class="pre">SMILESX.augm.</span></span><span class="sig-name descname"><span class="pre">augmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/augm.html#augmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.augm.augmentation" title="Permalink to this definition">#</a></dt>
<dd><p>Augmentation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_smiles</strong> – SMILES array for augmentation</p></li>
<li><p><strong>indices</strong> – Indices of the SMILES array for augmentation</p></li>
<li><p><strong>data_extra</strong> – Corresponding extra data array for augmentation</p></li>
<li><p><strong>data_prop</strong> – Corresponding property array for augmentation (default: None)</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to verify SMILES correctness via RDKit (default: True)</p></li>
<li><p><strong>augment</strong> (<em>bool</em>) – Whether to augment the data by atom rotation (default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>smiles_enum</em> – Array of augmented SMILES.</p></li>
<li><p><em>extra_enum</em> – Array of related additional inputs.</p></li>
<li><p><em>prop_enum</em> – Array of related property inputs.</p></li>
<li><p><em>miles_enum_card</em> – Number of augmentation per SMILES.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.augm.generate_smiles">
<span class="sig-prename descclassname"><span class="pre">SMILESX.augm.</span></span><span class="sig-name descname"><span class="pre">generate_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekule</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/augm.html#generate_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.augm.generate_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Generate SMILES list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – SMILES list to be prepared.</p></li>
<li><p><strong>kekule</strong> (<em>bool</em>) – Kekulize option setup. (Default: False)</p></li>
<li><p><strong>canon</strong> (<em>bool</em>) – Canonicalize. (Default: True)</p></li>
<li><p><strong>rotate</strong> (<em>bool</em>) – Rotation of atoms’s index for augmentation. (Default: False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>smiles_augment</strong> – A list of augmented SMILES (non-canonical equivalents from canonical SMILES representation).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.augm.rotate_atoms">
<span class="sig-prename descclassname"><span class="pre">SMILESX.augm.</span></span><span class="sig-name descname"><span class="pre">rotate_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">li</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/augm.html#rotate_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.augm.rotate_atoms" title="Permalink to this definition">#</a></dt>
<dd><p>Rotate atoms’ index in a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>li</strong> (<em>list</em>) – List to be rotated.</p></li>
<li><p><strong>x</strong> (<em>int</em>) – Index to be placed first in the list.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of rotated atoms.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.bayopt">
<span id="smilesx-bayopt-module"></span><h2>SMILESX.bayopt module<a class="headerlink" href="#module-SMILESX.bayopt" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.bayopt.bayopt_run">
<span class="sig-prename descclassname"><span class="pre">SMILESX.bayopt.</span></span><span class="sig-name descname"><span class="pre">bayopt_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_val_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_concat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_rounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bo_runs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_n_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/bayopt.html#bayopt_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.bayopt.bayopt_run" title="Permalink to this definition">#</a></dt>
<dd><p>Bayesian optimization of hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>np.array</em>) – Input SMILES.</p></li>
<li><p><strong>prop</strong> (<em>np.array</em>) – Input property values.</p></li>
<li><p><strong>extra</strong> (<em>np.array</em>) – Additional data input.</p></li>
<li><p><strong>train_val_idx</strong> (<em>list</em>) – List of indices for training and validation data for the current fold.</p></li>
<li><p><strong>tokens</strong> (<em>list</em>) – List of tokens contained within the dataset.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum length of SMILES in training and validation data.</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to check SMILES validity with RDKit.</p></li>
<li><p><strong>augmentation</strong> (<em>bool</em>) – Whether to perform data augmentation during bayesian optimization process.</p></li>
<li><p><strong>hyper_bounds</strong> (<em>dict</em>) – A dictionary of bounds {“param”:[bounds]}, where parameter <cite>“param”</cite> can be
embedding, LSTM, time-distributed dense layer units, batch size or learning
rate, and <cite>[bounds]</cite> is a list of possible values to be tested during
Bayesian optimization for a given parameter.</p></li>
<li><p><strong>hyper_opt</strong> (<em>dict</em>) – A dictionary of bounds {“param”:val}, where parameter <cite>“param”</cite> can be
embedding, LSTM, time-distributed dense layer units, batch size or learning
rate, and <cite>val</cite> is default value for a given parameter.</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em>) – Number of additional dense layers to be appended after attention layer.</p></li>
<li><p><strong>bo_rounds</strong> (<em>int</em>) – Number of rounds to be used during Bayesian optimization.</p></li>
<li><p><strong>bo_epochs</strong> (<em>int</em>) – Number of epochs required for training within the optimization frame.</p></li>
<li><p><strong>bo_runs</strong> (<em>int</em>) – Number of training repetitions with random train/val split.</p></li>
<li><p><strong>strategy</strong> – GPU memory growth strategy.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the model to be used. Can be either ‘regression’, ‘binary_classification’, or ‘multiclass_classification’.</p></li>
<li><p><strong>output_n_nodes</strong> (<em>int</em>) – Number of output nodes. (Default: 1 for regression and binary classification)
It equals to n_class (number of possible classes per output label) for multiclass classification.</p></li>
<li><p><strong>scale_output</strong> (<em>bool</em>) – Whether to scale the output property values or not. For binary classification tasks, it is recommended not to scale
the categorical (e.g. 0, 1) output values. For regression tasks, this is preferable to guarantee quicker
training convergence.</p></li>
<li><p><strong>pretrained_model</strong> – Pretrained model in case of the transfer learning (<cite>train_mode=’finetune’</cite>).
(Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hyper_opt</strong> – Dictionary with hyperparameters updated with optimized values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictdata_prop</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.embeddingvis">
<span id="smilesx-embeddingvis-module"></span><h2>SMILESX.embeddingvis module<a class="headerlink" href="#module-SMILESX.embeddingvis" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.embeddingvis.Embedding_Vis">
<span class="sig-prename descclassname"><span class="pre">SMILESX.embeddingvis.</span></span><span class="sig-name descname"><span class="pre">Embedding_Vis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_fold_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_fold_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../data/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../data/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affinity_propn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/embeddingvis.html#Embedding_Vis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.embeddingvis.Embedding_Vis" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-SMILESX.generation">
<span id="smilesx-generation-module"></span><h2>SMILESX.generation module<a class="headerlink" href="#module-SMILESX.generation" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.generation.Generation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.generation.</span></span><span class="sig-name descname"><span class="pre">Generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_run_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_augmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_augmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_use_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_use_n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./outputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./outputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_names_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/generation.html#Generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.generation.Generation" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for SMILES generation directed by SMILES-X targeted properties inference</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.data_name">
<span class="sig-name descname"><span class="pre">data_name</span></span><a class="headerlink" href="#SMILESX.generation.Generation.data_name" title="Permalink to this definition">#</a></dt>
<dd><p>dataset’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.g_run_number">
<span class="sig-name descname"><span class="pre">g_run_number</span></span><a class="headerlink" href="#SMILESX.generation.Generation.g_run_number" title="Permalink to this definition">#</a></dt>
<dd><p>number of the run to be considered for the generation model (Default: 0)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.gen_augmentation">
<span class="sig-name descname"><span class="pre">gen_augmentation</span></span><a class="headerlink" href="#SMILESX.generation.Generation.gen_augmentation" title="Permalink to this definition">#</a></dt>
<dd><p>SMILES’s augmentation at generator training (Default: False)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.infer_augmentation">
<span class="sig-name descname"><span class="pre">infer_augmentation</span></span><a class="headerlink" href="#SMILESX.generation.Generation.infer_augmentation" title="Permalink to this definition">#</a></dt>
<dd><p>SMILES’s augmentation at predictor training (Default: False)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.infer_use_n_folds">
<span class="sig-name descname"><span class="pre">infer_use_n_folds</span></span><a class="headerlink" href="#SMILESX.generation.Generation.infer_use_n_folds" title="Permalink to this definition">#</a></dt>
<dd><p>number of folds to be considered for the predictor model.
If put to None, all available folds are used for inference (Default: None)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.infer_use_n_runs">
<span class="sig-name descname"><span class="pre">infer_use_n_runs</span></span><a class="headerlink" href="#SMILESX.generation.Generation.infer_use_n_runs" title="Permalink to this definition">#</a></dt>
<dd><p>number of runs to be considered for the predictor model.
If put to None, all available runs are used for inference (Default: None)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.indir">
<span class="sig-name descname"><span class="pre">indir</span></span><a class="headerlink" href="#SMILESX.generation.Generation.indir" title="Permalink to this definition">#</a></dt>
<dd><p>directory of already trained prediction models (<em>.hdf5) and vocabulary (</em>.txt) (Default: ‘./outputs’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.outdir">
<span class="sig-name descname"><span class="pre">outdir</span></span><a class="headerlink" href="#SMILESX.generation.Generation.outdir" title="Permalink to this definition">#</a></dt>
<dd><p>directory for outputs (plots + .txt files) -&gt; ‘Inference/’+’{}/{}/’.format(data_name,g_dir_temp) is then created (Default: ‘./outputs’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.n_gpus">
<span class="sig-name descname"><span class="pre">n_gpus</span></span><a class="headerlink" href="#SMILESX.generation.Generation.n_gpus" title="Permalink to this definition">#</a></dt>
<dd><p>number of GPUs to use (Default: 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.gpus_list">
<span class="sig-name descname"><span class="pre">gpus_list</span></span><a class="headerlink" href="#SMILESX.generation.Generation.gpus_list" title="Permalink to this definition">#</a></dt>
<dd><p>list of GPUs to use (Default: None)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.gpus_debug">
<span class="sig-name descname"><span class="pre">gpus_debug</span></span><a class="headerlink" href="#SMILESX.generation.Generation.gpus_debug" title="Permalink to this definition">#</a></dt>
<dd><p>debug mode for GPUs (Default: False)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.prop_names_list">
<span class="sig-name descname"><span class="pre">prop_names_list</span></span><a class="headerlink" href="#SMILESX.generation.Generation.prop_names_list" title="Permalink to this definition">#</a></dt>
<dd><p>list of properties’ names (Default: None)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__(self,</span></span></dt>
<dd><p>data_name,
g_run_number = 0,
gen_augmentation = False,
infer_augmentation = False,
infer_use_n_folds = None,
infer_use_n_runs = None,
indir = “./output/”,
outdir = “./output/”,
vocab_name = ‘vocab’,
n_gpus = 1,
gpus_list = None,
gpus_debug = False,
prop_names_list = None)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">Initialize</span> <span class="pre">the</span> <span class="pre">class</span> <span class="pre">Generation</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">given</span> <span class="pre">parameters</span> <span class="pre">(see</span> <span class="pre">Attributes).</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.display">
<span class="sig-name descname"><span class="pre">display</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posterior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_tokens_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/generation.html#Generation.display"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.generation.Generation.display" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.generation.Generation.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_generate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diversity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_gamma_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/generation.html#Generation.generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.generation.Generation.generate" title="Permalink to this definition">#</a></dt>
<dd><p>Generate SMILES from the model.</p>
<dl class="simple">
<dt>starter: str</dt><dd><p>String of tokens to start with (Default: None, i.e. random)</p>
</dd>
<dt>n_generate: int</dt><dd><p>Number of SMILES to generate, must be a multiple of batch_size (Default: 1000)</p>
</dd>
<dt>top_k: int</dt><dd><p>Top k tokens to take into account for scoring (Default: None, i.e. no limit), must be &gt; 0 and &lt;= vocab_size (Default: None)</p>
</dd>
<dt>diversity: floatDataSequence</dt><dd><p>Diversity (or temperature) controller during sampling, must be &gt; 0 (Default: 1.)</p>
</dd>
<dt>batch_size: int</dt><dd><p>Number of smiles generated in parallel, must be a multiple of n_generate (Default: 128)</p>
</dd>
<dt>target_sf: str</dt><dd><p>Target sampling function, either ‘uniform’ or ‘gaussian’ (Default: ‘uniform’)</p>
</dd>
<dt>bounds_list<span class="classifier">list</span></dt><dd><p>list of properties’ bounds (Default: None)</p>
</dd>
<dt>tolerance: float</dt><dd><p>Tolerance for the target sampling function (Default: 10)</p>
</dd>
<dt>prop_gamma_list<span class="classifier">list</span></dt><dd><p>list of properties’ gamma (Default: None)</p>
</dd>
<dt>prior_gamma<span class="classifier">float</span></dt><dd><p>gamma for the prior (Default: 1.)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_smiles_list</strong> – List of generated SMILES</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-SMILESX.generative_main">
<span id="smilesx-generative-main-module"></span><h2>SMILESX.generative_main module<a class="headerlink" href="#module-SMILESX.generative_main" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.generative_main.generative_main">
<span class="sig-prename descclassname"><span class="pre">SMILESX.generative_main.</span></span><span class="sig-name descname"><span class="pre">generative_main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_concat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./outputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geomopt_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_augm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdense_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlin_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdense_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_rounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchsize_pergpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_schedule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_increase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_first_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/SMILESX/generative_main.html#generative_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.generative_main.generative_main" title="Permalink to this definition">#</a></dt>
<dd><p>Generative SMILESX main pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_smiles</strong> (<em>pd.DataFrame</em>) – A single or multiple columns pandas dataframe of SMILES as inputs.</p></li>
<li><p><strong>data_name</strong> (<em>str</em>) – Dataset name used for naming directories and files related to an intended study with the SMILES-X.
A good practice is to use the name of the dataset as a prefix for the output files and directories.
(Default: ‘Test’)</p></li>
<li><p><strong>smiles_concat</strong> (<em>bool</em>) – Whether to concatenate multiple SMILES per entry with the token ‘j’ standing for ‘join’.
This comes in handy if multiple SMILES are provided for a single entry, e.g. blends, etc.
(Default: False)</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Name of outputs directory.
(Default ‘./outputs’)</p></li>
<li><p><strong>geomopt_mode</strong> (<em>{'on'</em><em>, </em><em>'off'}</em>) – Whether to apply a trainless geometry optimisation for the LSTM, time-distributed
dense, and embedding layers.
(Default ‘off’)</p></li>
<li><p><strong>bayopt_mode</strong> (<em>{'on'</em><em>, </em><em>'off'}</em>) – Whether to perform a Bayesian optimisation for the LSTM, time-distributed
dense, and embedding layers, batch size and learning rate. If requested together with geometry
optimisation, only batch size and learning rate will be optimized.
(Default: ‘on’)</p></li>
<li><p><strong>train_mode</strong> (<em>{'on'</em><em>, </em><em>'finetune'</em><em>, </em><em>'off'}</em>) – <ul>
<li><p>‘on’ for training from scratch on a given dataset.</p></li>
<li><p>’finetune’ for fine-tuning a pretrained model. Requires ‘pretrained_data_name’ and ‘pretrained_augm’.</p></li>
<li><p>’off’ for just retrieving an existing trained model.</p></li>
</ul>
<p>(Default: ‘train’)</p>
</p></li>
<li><p><strong>pretrained_data_name</strong> (<em>str</em>) – The name of the data which was usd for pretraining.
(Default: ‘’)</p></li>
<li><p><strong>pretrained_augm</strong> (<em>bool</em>) – Whether augmentation was used or not during pretraining. It is used to build the path to the
pretrained model.
(Default: False)</p></li>
<li><p><strong>model_type</strong> (<em>{'regression'</em><em>, </em><em>'classification'}</em>) – Requests if the SMILES-X architecture should perform a regression, binary classification,
or multiclass classification task. Basically, the activation function of the last layer
will be set to ‘linear’, ‘sigmoid’, or ‘softmax’ respectively.
(Default: ‘regression’)</p></li>
<li><p><strong>scale_output</strong> (<em>bool</em>) – Whether to scale the output property values or not. For binary classification tasks,
it is recommended not to scale the categorical (e.g. 0, 1) output values.
For regression tasks, this is preferable to guarantee quicker training convergence.
(Default: True)</p></li>
<li><p><strong>embed_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Bounds constraining the Bayesian search for optimal embedding dimensions.
(Default: None)</p></li>
<li><p><strong>lstm_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Bounds constraining the Bayesian search for optimal LSTM layer dimensions.
(Default: None)</p></li>
<li><p><strong>tdense_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal time-distributed dense layer dimensions.
(Default: None)</p></li>
<li><p><strong>bs_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal batch size.
(Default: None)</p></li>
<li><p><strong>lr_bounds</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal learning rate.
(Default: None)</p></li>
<li><p><strong>embed_ref</strong> (<em>int</em>) – User defined number of dimensions of the dense embedding.
(Default: 512)</p></li>
<li><p><strong>lstm_ref</strong> (<em>int</em>) – User defined number of LSTM units.
(Default: 128)</p></li>
<li><p><strong>tdense_ref</strong> (<em>int</em>) – User defined number of units of the time-distributed dense layer.
(Default: 128)</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of dense layers added to the architecture between the attention layer and the last dense layer.
The size of every consecutive layer is set to half the size of the previous one.
(Default: None)</p></li>
<li><p><strong>bs_ref</strong> (<em>int</em>) – User defined batch size (no Bayesian optimisation).
(Default: 16)</p></li>
<li><p><strong>lr_ref</strong> (<em>int</em>) – User defined learning rate (no Bayesian optimisation) translated to the Adam optimizer as
10^(-lr_ref).
(Default: 3.9)</p></li>
<li><p><strong>run_index</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – List of indices of the runs of interest (e.g., [3, 5, 7]), other runs being skipped.
(Default: None)</p></li>
<li><p><strong>n_runs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of training repetitions with random train/val split performed during Bayesian optimisation.
(Default: None)</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to check the validity of the SMILES strings with RDKit.
(Default: True)</p></li>
<li><p><strong>augmentation</strong> (<em>bool</em>) – Whether to apply SMILES augmentation (i.e., de-canonicalization and exhaustive enumeration) or not.
This is recommended for small datasets and models’ performance improvement, even if this will increase
the training time.
(Default: False)</p></li>
<li><p><strong>geom_sample_size</strong> (<em>int</em>) – Number of data samples used for trainless geometry evaluation.
(Default: 32)</p></li>
<li><p><strong>bayopt_n_rounds</strong> (<em>int</em>) – Number of architectures to be sampled during Bayesian architecture search
(initialization + optimisation).
(Default: 25)</p></li>
<li><p><strong>bayopt_n_epochs</strong> (<em>int</em>) – Number of epochs used for training during hyperparameters Bayesian optimisation.
(Default: 30)</p></li>
<li><p><strong>bayopt_n_runs</strong> (<em>int</em>) – Number of trainings performed for sampled architectures during hyperparameters
Bayesian optimisation to average performance per architecture.
(Default: 3)</p></li>
<li><p><strong>n_gpus</strong> (<em>int</em>) – Number of GPUs to be used in parallel.
(Default: 1)</p></li>
<li><p><strong>gpus_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of GPU IDs to be used, e.g. [‘0’,’1’,’2’].
(Default: None)convert a list to a da</p></li>
<li><p><strong>gpus_debug</strong> (<em>bool</em>) – Print out the GPUs ongoing usage.
(Default: False)</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – Used for early stopping. Patience is the number of epochs before stopping training when
the validation error has stopped improving.
(Default: 25)</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.
(Default: 100)</p></li>
<li><p><strong>batchsize_pergpu</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size used per GPU.
If None, it is set in accordance with the augmentation statistics.
(Default: None)</p></li>
<li><p><strong>lr_schedule</strong> (<em>{'decay'</em><em>, </em><em>'clr'</em><em>, </em><em>'cosine'}</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Learning rate schedule</dt><dd><ul>
<li><p>’decay’: step decay (see <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/schedules/ExponentialDecay">https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/schedules/ExponentialDecay</a>)</p></li>
<li><p>’clr’: cyclical (see <a class="reference external" href="https://arxiv.org/abs/1506.01186">https://arxiv.org/abs/1506.01186</a>)</p></li>
<li><p>’cosine’: cosine annealing (see <a class="reference external" href="https://arxiv.org/abs/1608.03983">https://arxiv.org/abs/1608.03983</a>)</p></li>
<li><p>None: No learning rate schedule applied</p></li>
</ul>
</dd>
</dl>
<p>(Default: None)</p>
</p></li>
<li><p><strong>bs_increase</strong> (<em>bool</em>) – Increase batch size econvert a list to a davery N steps (see <a class="reference external" href="https://arxiv.org/abs/1711.00489">https://arxiv.org/abs/1711.00489</a>).
(Default: False)</p></li>
<li><p><strong>lr_min</strong> (<em>float</em>) – Minimum learning rate used during learning rate scheduling.
(Default: 1e-5)</p></li>
<li><p><strong>lr_max</strong> (<em>float</em>) – Maximum learning rate used during learning rate scheduling.
(Default: 1e-2)</p></li>
<li><p><strong>prec</strong> (<em>int</em>) – Precision of numerical values for printouts and plots.
(Default: 4)</p></li>
<li><p><strong>log_verbose</strong> (<em>bool</em>) – Whether or not to printout the logs into console.
(Default: True)</p></li>
<li><p><strong>train_verbose</strong> (<em>{0</em><em>, </em><em>1</em><em>, </em><em>2}</em>) – Verbosity during training. 0 = silent, 1 = progress bar, 2 = one line per epoch
(see <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit">https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit</a>).
(Default: 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>tokens list (vocabulary, .txt)</p></li>
<li><p>geometry optimisation scores (.csv)</p></li>
<li><p>list of optimized hyperparameters (.csv)</p></li>
<li><p>best architecture (.hdf5)</p></li>
<li><p>learning curves (.png)</p></li>
</ul>
<dl class="simple">
<dt>For classification tasks:</dt><dd><ul class="simple">
<li><p>confusion matrix (CM) plots for train, valid and test sets (.png)</p></li>
<li><p>precision-recall curve (PRC) plots for train, valid and test sets (.png)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>For each run the following outputs will be saved in outdir</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.genutils">
<span id="smilesx-genutils-module"></span><h2>SMILESX.genutils module<a class="headerlink" href="#module-SMILESX.genutils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.join_tokens">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">join_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_tmp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#join_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.join_tokens" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.normalize">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.normalize" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.p_to_one">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">p_to_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#p_to_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.p_to_one" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.remove_from_list">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">remove_from_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#remove_from_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.remove_from_list" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.remove_schar">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">remove_schar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_tmp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#remove_schar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.remove_schar" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.sample">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.sample" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.softmax">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">softmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#softmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.softmax" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.genutils.t_cdf">
<span class="sig-prename descclassname"><span class="pre">SMILESX.genutils.</span></span><span class="sig-name descname"><span class="pre">t_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/genutils.html#t_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.genutils.t_cdf" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-SMILESX.geomopt">
<span id="smilesx-geomopt-module"></span><h2>SMILESX.geomopt module<a class="headerlink" href="#module-SMILESX.geomopt" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.geomopt.geom_prescore">
<span class="sig-prename descclassname"><span class="pre">SMILESX.geomopt.</span></span><span class="sig-name descname"><span class="pre">geom_prescore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/geomopt.html#geom_prescore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.geomopt.geom_prescore" title="Permalink to this definition">#</a></dt>
<dd><p>Find the optimal weights for the trainless geometry search</p>
<p>Several architectures are randomly selected among all the possible combinations
and initialized with extensive range of weights. The least correlated weights are
selected for each architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – List of tokenized SMILES (training set data are passed from the main.py).</p></li>
<li><p><strong>extra</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – 2D array with additional numeric data.</p></li>
<li><p><strong>geom</strong> (<em>list</em>) – List of values for embedding, LSTM and time-distributed dense sizes,
defining a single geometry to be tested.</p></li>
<li><p><strong>extra_dim</strong> (<em>int</em>) – Dimensionality of the additional input data.</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em>) – The number of additional dense layers added after attention to deepen the network.
Can be used with and without <cite>data_extra</cite> data.</p></li>
<li><p><strong>vocab_size</strong> (<em>int</em>) – The size of the vocabulary.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum SMILES length within the data.</p></li>
<li><p><strong>strategy</strong> – GPU strategy to be used.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – The type of the model to be used. Can be either ‘regression’ or ‘classification’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_weights</strong> – List of the least correlated weight for the requested geometry</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.geomopt.geom_score">
<span class="sig-prename descclassname"><span class="pre">SMILESX.geomopt.</span></span><span class="sig-name descname"><span class="pre">geom_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/geomopt.html#geom_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.geomopt.geom_score" title="Permalink to this definition">#</a></dt>
<dd><p>Find the optimal weights for the trainless geometry search</p>
<p>Several architectures are randomly selected among all the possible combinations
and initialized with extensive range of weights. The least correlated weights are
selected for each architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – List of tokenized SMILES (training set data are passed from the main.py).</p></li>
<li><p><strong>extra</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – 2D array with additional numeric data.</p></li>
<li><p><strong>geom</strong> (<em>list</em>) – List of values for embedding, LSTM and time-distributed dense sizes,
defining a single geometry to be tested.</p></li>
<li><p><strong>extra_dim</strong> (<em>int</em>) – Dimensionality of the additional input data.</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em>) – The number of additional dense layers added after attention to deepen the network.
Can be used with and without <cite>data_extra</cite> data.</p></li>
<li><p><strong>weight</strong> (<em>list</em>) – List of weights to be used for constant shared weight initialization.</p></li>
<li><p><strong>vocab_size</strong> (<em>int</em>) – The size of the vocabulary.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum SMILES length within the data.</p></li>
<li><p><strong>strategy</strong> – GPU strategy to be used.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the model to be used. Can be either ‘regression’ or ‘classification’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>score</strong> (<em>float</em>) – Estimated score for the requested geometry.</p></li>
<li><p><strong>nparams</strong> (<em>int</em>) – Number of trainable parameters contained within the requested geometry.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.geomopt.geom_search">
<span class="sig-prename descclassname"><span class="pre">SMILESX.geomopt.</span></span><span class="sig-name descname"><span class="pre">geom_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/geomopt.html#geom_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.geomopt.geom_search" title="Permalink to this definition">#</a></dt>
<dd><p>Trainless geometry optimization.</p>
<p>The geometry optimization is performed by using a method of zero-cost model evaluation,
similar to the following paper:
E Gracheva, Array, Volume 12, 2021, 100082.</p>
<p>Candidate architectures are initialized with several shared constant weights,
and the one showing the lowest value of the coefficient of variation over the initializations,
normalized by the coefficient of variation over a fixed batch, is selected for training.</p>
<p>Only geometry-related hyperparameters are optimized (number of units in the LSTM layer,
time-distributed dense layer and embedding dimensionality). Other parameters should be optimized
via Bayesian optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_token</strong> (<em>list</em>) – List of tokenized SMILES (training set data are passed from the main.py).</p></li>
<li><p><strong>data_extra</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – 2D array with additional input data.</p></li>
<li><p><strong>subsample_size</strong> (<em>int</em>) – Size of the data sample used for trainless geometry evaluation.</p></li>
<li><p><strong>hyper_bounds</strong> (<em>dict</em>) – Dictionary of format {param_name:list(bounds)} containing hyperparameter bounds,
defines the search space.</p></li>
<li><p><strong>hyper_opt</strong> (<em>dict</em>) – Dictionary of format {param_name:value}. Initially the values are set to default ones,
then they are updated with optimal values during optimization.</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em>) – The number of additional dense layers added after attention to deepen the network.
Can be used with and without <cite>data_extra</cite> data.</p></li>
<li><p><strong>vocab_size</strong> (<em>int</em>) – The size of the vocabulary.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum SMILES length within the data.</p></li>
<li><p><strong>geom_file</strong> (<em>str</em>) – The name of the path to save the geometry scores.</p></li>
<li><p><strong>strategy</strong> – GPU strategy to be used.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – The type of the model to be used. Can be either ‘regression’ or ‘classification’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hyper_opt</strong> (<em>dict</em>) – Hyperparameters dictionary with geometry-related hyperparameters values updated.</p></li>
<li><p><strong>hyper_bounds</strong> (<em>dict</em>) – Hyperparameters dictionary with geometry-related bounds set to <cite>None</cite> to prevent
repeated optimization during consequent Bayesian optimization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.inference">
<span id="smilesx-inference-module"></span><h2>SMILESX.inference module<a class="headerlink" href="#module-SMILESX.inference" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.inference.infer">
<span class="sig-prename descclassname"><span class="pre">SMILESX.inference.</span></span><span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_concat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/inference.html#infer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.inference.infer" title="Permalink to this definition">#</a></dt>
<dd><p>Inference based on ensemble of trained SMILESX models</p>
<p>Prediction of the property based on the ensemble of SMILESX models.
Mean and standard deviation are computed over multiple models’ predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>list</em>) – The list of models to be used for inference.</p></li>
<li><p><strong>data_smiles</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – The list of SMILES to be characterized.</p></li>
<li><p><strong>data_extra</strong> – Additional data passed together with SMILES.</p></li>
<li><p><strong>smiles_concat</strong> (<em>bool</em>) – Whether to apply SMILES concatenation when multiple SMILES per entry are given.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – The batch size to be used for inference. (Default: 32)</p></li>
<li><p><strong>log_verbose</strong> (<em>bool</em>) – Whether to print the output to the console. (Default: True)</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to check the SMILES via RDKit. (Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe of SMILES with their inferred property (SMILES, mean, standard deviation)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.interpret">
<span id="smilesx-interpret-module"></span><h2>SMILESX.interpret module<a class="headerlink" href="#module-SMILESX.interpret" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.interpret.get_similarity_map_from_weights">
<span class="sig-prename descclassname"><span class="pre">SMILESX.interpret.</span></span><span class="sig-name descname"><span class="pre">get_similarity_map_from_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorMap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(250,</span> <span class="pre">250)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordScale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contourLines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/interpret.html#get_similarity_map_from_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.interpret.get_similarity_map_from_weights" title="Permalink to this definition">#</a></dt>
<dd><p>Generates the similarity map for a molecule given the atomic weights.</p>
<p>Attention weights depiction from
<a class="github reference external" href="https://github.com/rdkit/rdkit/blob/24f1737839c9302489cadc473d8d9196ad9187b4/rdkit/Chem/Draw/SimilarityMaps.py">rdkit/rdkit</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>RDKit.mol</em>) – The molecule of interest.</p></li>
<li><p><strong>weights</strong> – Attention weights representing the importance of each token.</p></li>
<li><p><strong>pred_val</strong> (<em>str</em>) – Predicted property value to be displayed.</p></li>
<li><p><strong>true_val</strong> (<em>str</em><em>, </em><em>optional</em>) – Ground truth property value to be displayed.</p></li>
<li><p><strong>colorMap</strong> – The matplotlib color map scheme, default is custom PiWG color map.</p></li>
<li><p><strong>size</strong> (<em>(</em><em>int</em><em>, </em><em>int</em><em>)</em>) – The size of the figure.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – The sigma for the Gaussians.</p></li>
<li><p><strong>coordScale</strong> (<em>float</em>) – Scaling factor for the coordinates.</p></li>
<li><p><strong>step</strong> (<em>float</em>) – The step for calcAtomGaussian.</p></li>
<li><p><strong>colors</strong> (<em>str</em>) – Color of the contour lines (Default: ‘k’).</p></li>
<li><p><strong>contourLines</strong> (<em>int</em><em>, </em><em>list</em><em>(</em><em>int</em><em>)</em>) – If integer, the number of contour lines to be drawn.
If list, the positions of contour lines to be drawn.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The alpha channel (transparancy degree) for the contour lines.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for drawing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure with similarity map for a molecule given the attention weights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.interpret.interpret">
<span class="sig-prename descclassname"><span class="pre">SMILESX.interpret.</span></span><span class="sig-name descname"><span class="pre">interpret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_concat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'horizontal'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/interpret.html#interpret"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.interpret.interpret" title="Permalink to this definition">#</a></dt>
<dd><p>Inference based on ensemble of trained SMILESX models</p>
<p>Prediction of the property based on the ensemble of SMILESX models.
Mean and standard deviation are computed over multiple models’ predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>list</em>) – The list of models to be used for inference</p></li>
<li><p><strong>smiles</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – The list of SMILES to be characterized</p></li>
<li><p><strong>log_verbose</strong> (<em>bool</em>) – Whether to print the output to the consol (Default: True)</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to check the SMILES via RDKit (Default: True)</p></li>
<li><p><strong>font_size</strong> (<em>int</em>) – Size of the font SMILES tokens. (Default: 15)</p></li>
<li><p><strong>font_rotation</strong> (<em>{'horizontal'</em><em>, </em><em>'vertical'}</em>) – font’s size for writing SMILES tokens (Default: 15)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe of SMILES with their inferred property (SMILES, mean, standard deviation)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.loadmodel">
<span id="smilesx-loadmodel-module"></span><h2>SMILESX.loadmodel module<a class="headerlink" href="#module-SMILESX.loadmodel" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.loadmodel.LoadModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.loadmodel.</span></span><span class="sig-name descname"><span class="pre">LoadModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_n_folds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./outputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/loadmodel.html#LoadModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.loadmodel.LoadModel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Load an ensemble of trained models.</p>
<p>Collects all the available trained models for a given dataset.
Allows to keep the collected models in memory for multiple utilisation.
Full models are collected for inference, truncated models are collected for interpretation
(models are truncated at the level of attention, with attention vectors output).</p>
<p>Verifies the availability of all the necessary files in the requested directory at initilisation.
The following conditions must be fulfilled:</p>
<blockquote>
<div><ul class="simple">
<li><p>Vocabulary file must exist.
Without vocabulary file SMILES cannot be properly tokenized to be fed into a model.</p></li>
<li><p>The number of scalers for the output data and additional input data (if used) should match.</p></li>
</ul>
</div></blockquote>
<p>The number of folds <cite>k_fold_number</cite> and/or <cite>n_runs</cite> are automatically set based on the number of scalers
in the <cite>Train/Other/Scalers/</cite> directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_name</strong> (<em>str</em>) – The name of the data used for training.</p></li>
<li><p><strong>augment</strong> (<em>bool</em>) – Whether augmentation has been used for training.</p></li>
<li><p><strong>use_n_folds</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of folds to be used. If not specified, all available folds will be used.
(Default: None)</p></li>
<li><p><strong>use_n_runs</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of runs to be used. If not specified, all available runs will be used.
(Default: None)</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – The path to the directory SMILES-X output directory.
(Default: “./outputs”)</p></li>
<li><p><strong>gpu_ind</strong> (<em>int</em>) – The index of the GPU to be used (single GPU usage only).
(Default: 0)</p></li>
<li><p><strong>gpu_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the GPU to be used.
(Default: None)</p></li>
<li><p><strong>strategy</strong> – Memory growth strategy.
(Default: None)</p></li>
<li><p><strong>log_verbose</strong> (<em>bool</em>) – Whether to output the logs to the console. If set to False, outputs will be
directed towards the logfile only.
(Default: True)</p></li>
<li><p><strong>return_attention</strong> (<em>bool</em>) – If <cite>True</cite>, collect full models (e.g., for inference). Otherwise collect
truncated models (e.g., for interpretation).
(Default: True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A class containing a dictionary of trained models per fold per run,</em></p></li>
<li><p><em>output scalers, additional input data scalers if applicable, information</em></p></li>
<li><p><em>on the number of k-folds and runs, as well as training data path.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.main">
<span id="smilesx-main-module"></span><h2>SMILESX.main module<a class="headerlink" href="#module-SMILESX.main" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.main.main">
<span class="sig-prename descclassname"><span class="pre">SMILESX.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_prop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_concat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./outputs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geomopt_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'on'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_augm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdense_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlin_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdense_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_fold_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_fold_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_smiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_sample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_rounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt_n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gpus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchsize_pergpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_schedule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bs_increase</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_first_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/SMILESX/main.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.main.main" title="Permalink to this definition">#</a></dt>
<dd><p>SMILESX main pipeline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_smiles</strong> (<em>pd.DataFrame</em>) – A single or multiple columns pandas dataframe of SMILES as inputs.</p></li>
<li><p><strong>data_prop</strong> (<em>pd.DataFrame</em>) – A single column pandas dataframe of true property values as outputs, e.g. experimental measurements, etc.
It should have the same length than the provided set of input SMILES.</p></li>
<li><p><strong>data_err</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – A single column dataframe of standard deviations, or a two columns dataframe of minimum and maximum values,
related to the property values. It should have the same length than the provided set of input SMILES.
If standard deviations are provided, symmetric errorbars will be plotted in the output figures.
And if [min, max] ranges are provided, asymmetric error bars will be plotted in accordance
with the min and max values.
(Default: None)</p></li>
<li><p><strong>data_extra</strong> (<em>pd.DataFrame</em><em>, </em><em>optional</em>) – A single or multi columns pandas dataframe of additional input data intended to be used as extra descriptors
joined to the SMILES alone. It should have the same length than the provided set of input SMILES.
(Default: None)</p></li>
<li><p><strong>data_name</strong> (<em>str</em>) – Dataset name used for naming directories and files related to an intended study with the SMILES-X.
A good practice is to use the name of the dataset as a prefix for the output files and directories.
(Default: ‘Test’)</p></li>
<li><p><strong>data_units</strong> (<em>str</em><em>, </em><em>optional</em>) – Desired output property’s unit to be displayed in plots.
(Default: ‘’)</p></li>
<li><p><strong>data_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Desired output property’s label to be displayed in plots.
The TeX formmat is supported according to the matplotlib’s documentation (see
<a class="reference external" href="https://matplotlib.org/stable/gallery/text_labels_and_annotations/tex_demo.html">https://matplotlib.org/stable/gallery/text_labels_and_annotations/tex_demo.html</a>).
(Default: ‘’)</p></li>
<li><p><strong>smiles_concat</strong> (<em>bool</em>) – Whether to concatenate multiple SMILES per entry with the token ‘j’ standing for ‘join’.
This comes in handy if multiple SMILES are provided for a single entry, e.g. blends, etc.
(Default: False)</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Name of outputs directory.
(Default ‘./outputs’)</p></li>
<li><p><strong>geomopt_mode</strong> (<em>{'on'</em><em>, </em><em>'off'}</em>) – Whether to apply a trainless geometry optimisation for the LSTM, time-distributed
dense, and embedding layers.
(Default ‘off’)</p></li>
<li><p><strong>bayopt_mode</strong> (<em>{'on'</em><em>, </em><em>'off'}</em>) – Whether to perform a Bayesian optimisation for the LSTM, time-distributed
dense, and embedding layers, batch size and learning rate. If requested together with geometry
optimisation, only batch size and learning rate will be optimized.
(Default: ‘on’)</p></li>
<li><p><strong>train_mode</strong> (<em>{'on'</em><em>, </em><em>'finetune'</em><em>, </em><em>'off'}</em>) – ‘on’ for training from scratch on a given dataset.
‘finetune’ for fine-tuning a pretrained model. Requires <cite>pretrained_data_name</cite> and <cite>pretrained_augm</cite>.
‘off’ for just retrieving an existing trained model.
(Default: ‘train’)</p></li>
<li><p><strong>pretrained_data_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the data which was usd for pretraining
(Default: ‘’)</p></li>
<li><p><strong>pretrained_augm</strong> (<em>bool</em>) – Whether augmentation was used or not during pretraining. It is used to build the path to the
pretrained model.
(Default: False)</p></li>
<li><p><strong>model_type</strong> (<em>{'regression'</em><em>, </em><em>'classification'}</em>) – Requests if the SMILES-X architecture should perform a regression, binary classification,
or multiclass classification task. Basically, the activation function of the last layer
will be set to ‘linear’, ‘sigmoid’, or ‘softmax’ respectively.
(Default: ‘regression’)</p></li>
<li><p><strong>scale_output</strong> (<em>bool</em>) – Whether to scale the output property values or not. For binary classification tasks,
it is recommended not to scale  the categorical (e.g. 0, 1) output values.
For regression tasks, this is preferable to guarantee quicker training convergence.
(Default: True)</p></li>
<li><p><strong>embed_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Bounds constraining the Bayesian search for optimal embedding dimensions.
(Default: None)</p></li>
<li><p><strong>lstm_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Bounds constraining the Bayesian search for optimal LSTM layer dimensions.
(Default: None)</p></li>
<li><p><strong>tdense_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal time-distributed dense layer dimensions.
(Default: None)</p></li>
<li><p><strong>bs_bounds</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal batch size.
(Default: None)</p></li>
<li><p><strong>lr_bounds</strong> (<em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Bounds constraining the Bayesian search for optimal learning rate.
(Default: None)</p></li>
<li><p><strong>embed_ref</strong> (<em>int</em>) – User defined number of dimensions of the dense embedding.
(Default: 512)</p></li>
<li><p><strong>lstm_ref</strong> (<em>int</em>) – User defined number of LSTM units.
(Default: 128)</p></li>
<li><p><strong>tdense_ref</strong> (<em>int</em>) – User defined number of units of the time-distributed dense layer.
(Default: 128)</p></li>
<li><p><strong>dense_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of dense layers added to the architecture between the attention layer and the last dense layer.
The size of every consecutive layer is set to half the size of the previous one.
(Default: None)</p></li>
<li><p><strong>bs_ref</strong> (<em>int</em>) – User defined batch size (no Bayesian optimisation).
(Default: 16)</p></li>
<li><p><strong>lr_ref</strong> (<em>int</em>) – User defined learning rate (no Bayesian optimisation) translated to the Adam optimizer as
10^(-lr_ref).
(Default: 3.9)</p></li>
<li><p><strong>k_fold_number</strong> (<em>int</em>) – Number of folds used for a k-fold cross-validation.
(Default: 5)</p></li>
<li><p><strong>k_fold_index</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – List of indices of the folds of interest (e.g., [3, 5, 7]), other folds being skipped.
(Default: None)</p></li>
<li><p><strong>run_index</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – List of indices of the runs of interest (e.g., [3, 5, 7]), other runs being skipped.
(Default: None)</p></li>
<li><p><strong>n_runs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of training repetitions with random train/val split performed during Bayesian optimisation.
(Default: None)</p></li>
<li><p><strong>check_smiles</strong> (<em>bool</em>) – Whether to check the validity of the SMILES strings with RDKit.
(Default: True)</p></li>
<li><p><strong>augmentation</strong> (<em>bool</em>) – Whether to apply SMILES augmentation (i.e., de-canonicalization and exhaustive enumeration) or not.
This is recommended for small datasets and models’ performance improvement, even if this will increase
the training time.
(Default: False)</p></li>
<li><p><strong>geom_sample_size</strong> (<em>int</em>) – Number of data samples used for trainless geometry evaluation.
(Default: 32)</p></li>
<li><p><strong>bayopt_n_rounds</strong> (<em>int</em>) – Number of architectures to be sampled during Bayesian architecture search
(initialization + optimisation).
(Default: 25)</p></li>
<li><p><strong>bayopt_n_epochs</strong> (<em>int</em>) – Number of epochs used for training during hyperparameters Bayesian optimisation.
(Default: 30)</p></li>
<li><p><strong>bayopt_n_runs</strong> (<em>int</em>) – Number of trainings performed for sampled architectures during hyperparameters
Bayesian optimisation to average performance per architecture.
(Default: 3)</p></li>
<li><p><strong>n_gpus</strong> (<em>int</em>) – Number of GPUs to be used in parallel.
(Default: 1)</p></li>
<li><p><strong>gpus_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of GPU IDs to be used, e.g. [‘0’,’1’,’2’].
(Default: None)convert a list to a da</p></li>
<li><p><strong>gpus_debug</strong> (<em>bool</em>) – Print out the GPUs ongoing usage.
(Default: False)</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – Used for early stopping. Patience is the number of epochs before stopping training when
the validation error has stopped improving.
(Default: 25)</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.
(Default: 100)</p></li>
<li><p><strong>batchsize_pergpu</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size used per GPU.
If None, it is set in accordance with the augmentation statistics.
(Default: None)</p></li>
<li><p><strong>lr_schedule</strong> (<em>{'decay'</em><em>, </em><em>'clr'</em><em>, </em><em>'cosine'}</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Learning rate schedule</dt><dd><ul>
<li><p>’decay’: step decay (see <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/schedules/ExponentialDecay">https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/schedules/ExponentialDecay</a>)</p></li>
<li><p>’clr’: cyclical (see <a class="reference external" href="https://arxiv.org/abs/1506.01186">https://arxiv.org/abs/1506.01186</a>)</p></li>
<li><p>’cosine’: cosine annealing (see <a class="reference external" href="https://arxiv.org/abs/1608.03983">https://arxiv.org/abs/1608.03983</a>)</p></li>
<li><p>None: No learning rate schedule applied</p></li>
</ul>
</dd>
</dl>
<p>(Default: None)</p>
</p></li>
<li><p><strong>bs_increase</strong> (<em>bool</em>) – Increase batch size econvert a list to a davery N steps (see <a class="reference external" href="https://arxiv.org/abs/1711.00489">https://arxiv.org/abs/1711.00489</a>).
(Default: False)</p></li>
<li><p><strong>lr_min</strong> (<em>float</em>) – Minimum learning rate used during learning rate scheduling.
(Default: 1e-5)</p></li>
<li><p><strong>lr_max</strong> (<em>float</em>) – Maximum learning rate used during learning rate scheduling.
(Default: 1e-2)</p></li>
<li><p><strong>prec</strong> (<em>int</em>) – Precision of numerical values for printouts and plots.
(Default: 4)</p></li>
<li><p><strong>log_verbose</strong> (<em>bool</em>) – Whether or not to printout the logs into console.
(Default: True)</p></li>
<li><p><strong>train_verbose</strong> (<em>{0</em><em>, </em><em>1</em><em>, </em><em>2}</em>) – Verbosity during training. 0 = silent, 1 = progress bar, 2 = one line per epoch
(see <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit">https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit</a>).
(Default: 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>tokens list (vocabulary, .txt)</p></li>
<li><p>scaler (.pkl)</p></li>
<li><p>geometry optimisation scores (.csv)</p></li>
<li><p>list of optimized hyperparameters (.csv)</p></li>
<li><p>best architecture (.hdf5)</p></li>
<li><p>learning curves (.png)</p></li>
</ul>
<dl class="simple">
<dt>For regression tasks:</dt><dd><ul class="simple">
<li><p>predictions vs observations plots (all sets together, .png)</p></li>
</ul>
</dd>
<dt>For classification tasks:</dt><dd><ul class="simple">
<li><p>confusion matrix (CM) plots for train, valid and test sets (.png)</p></li>
<li><p>precision-recall curve (PRC) plots for train, valid and test sets (.png)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>For each fold and run the following outputs will be saved in outdir</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.model">
<span id="smilesx-model-module"></span><h2>SMILESX.model module<a class="headerlink" href="#module-SMILESX.model" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.model.LSTMAttModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.model.</span></span><span class="sig-name descname"><span class="pre">LSTMAttModel</span></span><a class="reference internal" href="_modules/SMILESX/model.html#LSTMAttModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.LSTMAttModel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Builds neural architecture of the SMILESX</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tokens</strong> (<em>int</em>) – Maximum length for the encoded and tokenized SMILES</p></li>
<li><p><strong>vocab_size</strong> (<em>int</em>) – Size of the vocabulary</p></li>
<li><p><strong>embed_units</strong> (<em>int</em>) – Dimension of the embedding</p></li>
<li><p><strong>lstm_units</strong> (<em>int</em>) – The number of LSTM units</p></li>
<li><p><strong>tdense_units</strong> (<em>int</em>) – The number of dense units</p></li>
<li><p><strong>geom_search</strong> (<em>bool</em>) – Whether to initialize the weight with shared constant for geometry search (Defaults: False)</p></li>
<li><p><strong>return_prob</strong> (<em>bool</em>) – Whether to return the attention vector or not (Default: False)</p></li>
<li><p><strong>weight</strong> (<em>int</em><em>, </em><em>float</em>) – The value of the shared constant weights used for layer initialization (Default: None)</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – The type of the model. Can be either ‘regression’ (last_activation = ‘linear’),
‘binary_classification’ (last_activation = ‘sigmoid’), or ‘multiclass_classification’ (last_activation = ‘softmax’).
For a molecular language modeling task, the model_type must be set to ‘multiclass_classification’.
(Default: ‘regression’)</p></li>
<li><p><strong>output_n_nodes</strong> (<em>int</em>) – The number of output nodes. (Default: 1 for regression and binary classification)
It equals to n_class (number of possible classes per output label) for multiclass classification.
It equals to the size of the vocabulary for a molecular language modeling task.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A model in the Keras API format</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.Model</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.LSTMAttModel.create">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdense_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_n_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#LSTMAttModel.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.LSTMAttModel.create" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.model.</span></span><span class="sig-name descname"><span class="pre">SoftAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom_search</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.build" title="Permalink to this definition">#</a></dt>
<dd><p>Builds and initializes attention layer</p>
<p>If <cite>geom_search</cite> parameter is set to <cite>True</cite>, the weights are initialized with a shared constant value
defined with <cite>weight</cite> parameter. If <cite>geom_search</cite> is set to <cite>False</cite>, GlorotNormal weight initialization is applied.</p>
<p>Weights’ tensor shape is (EMBED_SIZE, 1), bias tensor shape is (MAX_TOKENS, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_shape</strong> (<em>tuple</em>) – Input tensor shape. Passed internally by Keras between layers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.call" title="Permalink to this definition">#</a></dt>
<dd><p>Computes an attention vector on an input matrix</p>
<p>Collapses the tokens dimension by summing up the products of
the each of the token’s weights with corresponding to this token matrix values.
The weights are optimized during the training.</p>
<p>Dimensions:
et: (batch_size, max_tokens)
at: (batch_size, max_tokens)
ot: (batch_size, max_tokens, tdense_units)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tensor</em>) – The output from the time-distributed dense layer (batch_size, max_tokens, tdense_units).</p></li>
<li><p><strong>input_tensor</strong> (<em>tensor</em><em>, </em><em>optional</em>) – The input tensor from which masks are created (batch_size, max_tokens).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>During training and prediction</em> – 2D tensor of shape (batch_size, embed_size)</p></li>
<li><p><em>During interpretation (visualization)</em> – 1D tensor of shape (max_tokens, )</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.compute_output_shape">
<span class="sig-name descname"><span class="pre">compute_output_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.compute_output_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.compute_output_shape" title="Permalink to this definition">#</a></dt>
<dd><p>Compute output tensor shape</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.create_masks">
<span class="sig-name descname"><span class="pre">create_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.create_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.create_masks" title="Permalink to this definition">#</a></dt>
<dd><p>Creates all masks</p>
<p>The create_masks method takes an input tensor as input and
uses the create_padding_mask method to create a padding mask for the input sequence.
The padding mask is then multiplied by a negative value (-1e9) and returned as the output.
This is done to assign a very low attention weight to the padded positions in the sequence
during further computations, effectively ignoring them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_tensor</strong> (<em>tensor</em>) – The input tensor of shape (batch_size, max_tokens)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>masks</strong> – The masks of shape (batch_size, max_tokens)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masks</span> <span class="o">=</span> <span class="n">create_masks</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masks</span>
<span class="go">&lt;tf.Tensor: shape=(2, 5), dtype=float32, numpy=</span>
<span class="go">array([[0., 0., 0., -1e9, -1e9],</span>
<span class="go">        [0., 0., -1e9, -1e9, -1e9]], dtype=float32)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.create_padding_mask">
<span class="sig-name descname"><span class="pre">create_padding_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.create_padding_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.create_padding_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a padding mask</p>
<p>The create_padding_mask method takes a sequence as input and creates a mask matrix where
all the elements that are equal to 0 in the input sequence are set to 1, while all the other
elements are set to 0. This is achieved using the K.cast(K(input_tensor, 0), dtype=’float32’) function
in TensorFlow. The output of this method is a mask matrix of the same shape as the input sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_tensor</strong> (<em>tensor</em>) – The input tensor of shape (batch_size, max_tokens)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>padding_mask</strong> – The padding mask of shape (batch_size, max_tokens)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tensor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padding_mask</span> <span class="o">=</span> <span class="n">create_padding_mask</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padding_mask</span>
<span class="go">&lt;tf.Tensor: shape=(2, 5), dtype=float32, numpy=</span>
<span class="go">array([[0., 0., 0., 1., 1.],</span>
<span class="go">       [0., 0., 1., 1., 1.]], dtype=float32)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.model.SoftAttention.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/model.html#SoftAttention.get_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.model.SoftAttention.get_config" title="Permalink to this definition">#</a></dt>
<dd><p>Get configration of the layer</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-SMILESX.token">
<span id="smilesx-token-module"></span><h2>SMILESX.token module<a class="headerlink" href="#module-SMILESX.token" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.extract_vocab">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">extract_vocab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lltokens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#extract_vocab"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.extract_vocab" title="Permalink to this definition">#</a></dt>
<dd><p>Vocabulary extraction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lltokens</strong> (<em>list</em>) – list of lists of tokens (list of tokenized SMILES)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing all the individual tokens</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.get_inttotoken">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">get_inttotoken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#get_inttotoken"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.get_inttotoken" title="Permalink to this definition">#</a></dt>
<dd><p>Translates string tokens into integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens</strong> (<em>list</em>) – List of tokens</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with ingeres as keys and corresponding tokens as values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.get_tokens">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">get_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#get_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.get_tokens" title="Permalink to this definition">#</a></dt>
<dd><p>Gets tokens from a list of tokens from SMILES</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list</em>) – List of of SMILES</p></li>
<li><p><strong>split_l</strong> (<em>int</em>) – Number of tokens contained within a split (default: 1)
Result examples for different <cite>split_l</cite> values:
split_l = 1 -&gt; np.array([‘CC=O’]) =&gt; [[’ ‘, ‘C’, ‘C’, ‘=’, ‘O’, ‘ ‘]],
split_l = 2 -&gt; np.array([‘CC=O’]) =&gt; [[’ C’, ‘CC’, ‘C=’, ‘=O’, ‘O ‘]],
split_l = 3 -&gt; np.array([‘CC=O’]) =&gt; [[’ CC’, ‘CC=’, ‘C=O’, ‘=O ‘]],</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tokenized_smiles_list</strong> – List of tokenized SMILES</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.get_tokentoint">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">get_tokentoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#get_tokentoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.get_tokentoint" title="Permalink to this definition">#</a></dt>
<dd><p>Translates string tokens into integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens</strong> (<em>list</em>) – List of tokens</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with tokens as keys and corresponding integers as values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.get_vocab">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">get_vocab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#get_vocab"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.get_vocab" title="Permalink to this definition">#</a></dt>
<dd><p>Retrieves previously saved vocabulary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens_file</strong> – Text file name with directory in which the vocabulary is saved (.txt)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Set of individual tokens forming a vocabulary</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tokens</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.int_vec_encode">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">int_vec_encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenized_smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#int_vec_encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.int_vec_encode" title="Permalink to this definition">#</a></dt>
<dd><p>Encodes SMILES as a vector of integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokenized_smiles_list</strong> (<em>list</em><em>(</em><em>list</em><em>(</em><em>str</em><em>)</em><em>)</em>) – List of tokenized SMILES, where every list(str) corresponds to a single SMILES.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum SMILES length</p></li>
<li><p><strong>vocab</strong> – Vocabulary, or a list of all possible tokens contained within the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>int_smiles_array</strong> – Numpy array of encoded SMILES of shape (len(tokenized_smiles_list), max_length).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.onehot">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">onehot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#onehot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.onehot" title="Permalink to this definition">#</a></dt>
<dd><p>Encodes last token to one-hot vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_array</strong> (<em>array</em>) – Array of last tokens (number of tokens,) to be encoded</p></li>
<li><p><strong>vocab_size</strong> (<em>int</em>) – Size of the vocabulary which defines the size of a one-hot vetor</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>one_hot</strong> – Array of one-vectors (number of tokens, vocab_size)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.save_vocab">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">save_vocab</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokens_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#save_vocab"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.save_vocab" title="Permalink to this definition">#</a></dt>
<dd><p>Stores vocabulary for further use of trained models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vocab</strong> (<em>list</em>) – List of tokens formin vocabulary</p></li>
<li><p><strong>tokens_file</strong> (<em>str</em>) – Name of the file to store the vocabulary (.txt)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.token.smiles_tokenizer">
<span class="sig-prename descclassname"><span class="pre">SMILESX.token.</span></span><span class="sig-name descname"><span class="pre">smiles_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/token.html#smiles_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.token.smiles_tokenizer" title="Permalink to this definition">#</a></dt>
<dd><p>Tokenize SMILES</p>
<p>Splits molecules into tokens, which represent:
aliphatic organic compounds, aromatic organic compounds,
isotopes, chirality, hydrogen count, charge, class (with respective squared brackets)
bonds, rings, wildcards and branches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>str</em>) – Input SMILES string to tokenize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>tokenized_smiles_list</strong> – List of tokens extended with a termination character ‘ ‘</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(str)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.trainutils">
<span id="smilesx-trainutils-module"></span><h2>SMILESX.trainutils module<a class="headerlink" href="#module-SMILESX.trainutils" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.CosineAnneal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">CosineAnneal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CosineAnneal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CosineAnneal" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.CxUxN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">CxUxN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gen_max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_generate=1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_up=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_fcn=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_dir=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CxUxN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CxUxN" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implement CxUxN score calculation during training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_data</strong> (<em>list</em>) – List of initial SMILES</p></li>
<li><p><strong>data_name</strong> (<em>str</em>) – Name of the dataset</p></li>
<li><p><strong>vocab</strong> (<em>list</em>) – List of tokens</p></li>
<li><p><strong>gen_max_length</strong> (<em>int</em>) – Maximum length of the generated SMILES</p></li>
<li><p><strong>gpus</strong> (<em>list</em>) – List of GPUs to use</p></li>
<li><p><strong>model_init</strong> (<em>keras model</em>) – Model to use for generation</p></li>
<li><p><strong>n_generate</strong> (<em>int</em>) – Number of SMILES to generate</p></li>
<li><p><strong>warm_up</strong> (<em>int</em>) – Number of epochs to wait before to start generation</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
<li><p><strong>print_fcn</strong> (<em>function</em>) – Function to use for printing</p></li>
<li><p><strong>model_dir</strong> (<em>str</em>) – Path to the directory where the model is saved.</p></li>
<li><p><strong>run</strong> (<em>int</em>) – Number of the run</p></li>
<li><p><strong>results_dir</strong> (<em>str</em>) – Path to the directory where the results are saved.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether to print the evaluation of a generation</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluation of the generation through the CUN score</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.CxUxN.evaluation">
<span class="sig-name descname"><span class="pre">evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CxUxN.evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CxUxN.evaluation" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.CxUxN.on_evaluation_end">
<span class="sig-name descname"><span class="pre">on_evaluation_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CxUxN.on_evaluation_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CxUxN.on_evaluation_end" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.CyclicLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">CyclicLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.006</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'triangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cycle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CyclicLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CyclicLR" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Implement a cyclical learning rate policy.</p>
<p>The method is presented by Leslie N. Smith in the paper
‘Cyclical learning rates for training neural networks’ (IEEE WACV, 2017)
Learning rate is changed between two boundaries with some constant frequency.
The boudaries ar define as <cite>base_lr</cite> and <cite>max_lr</cite>, and their difference corresponds
to the amplitude. At every iteration, the learning rate is defined as the sum of <cite>base_lr</cite>
and scaled amplitude. Scaling can be done on per-iteration or per-cycle bases.</p>
<dl class="simple">
<dt><a class="reference internal" href="#SMILESX.trainutils.CyclicLR" title="SMILESX.trainutils.CyclicLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicLR</span></code></a> class has three built-in scaling policies:</dt><dd><ul class="simple">
<li><p><cite>triangular</cite>
Basic triangular cycle with no amplitude scaling.</p></li>
<li><p><cite>triangular2</cite>
Basic triangular cycle that scales initial amplitude by half each cycle.</p></li>
<li><p><cite>exp_range</cite>
Cycle that scales initial amplitude by gamma**(cycle iterations) at each iteration.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_lr</strong> (<em>float</em>) – Initial learning rate which is the lower boundary in the cycle.
(Default 0.001)</p></li>
<li><p><strong>max_lr</strong> (<em>float</em>) – Upper boundary for the learning rate used for amplitude calculation,
may not be actually reached. (Default 0.006)</p></li>
<li><p><strong>step_size</strong> (<em>int</em>) – Number of training iterations per half cycle. Authors suggest setting
<cite>step_size</cite> to 2-8 x training iterations per epoch. (Default 2000)</p></li>
<li><p><strong>mode</strong> (<em>{'triangular'</em><em>, </em><em>'triangular2'</em><em>, </em><em>'exp_range'}</em>) – Policies which define the amplitude scaling as a function of iterations.
If <cite>scale_fn</cite> is not <cite>None</cite>, <cite>mode</cite> argument is ignored. (Default ‘triangular’)</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – A constant used in ‘exp_range’ scaling function: gamma**(cycle iterations).
(Default 1.)</p></li>
<li><p><strong>scale_fn</strong> (<em>lambda</em>) – Custom scaling policy defined by a single argument lambda function,
where 0 &lt;= scale_fn(x) &lt;= 1 for all x &gt;= 0. If <cite>scale_fn</cite> is not <cite>None</cite>,
<cite>mode</cite> argument is ignored. (Default None)</p></li>
<li><p><strong>scale_mode</strong> (<em>{'cycle'</em><em>, </em><em>'iterations'}</em>) – Defines whether <cite>scale_fn</cite> is evaluated based on cycle number or cycle
iterations (training iterations since start of cycle). (Default ‘cycle’)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clr</span> <span class="o">=</span> <span class="n">CyclicLR</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.006</span><span class="p">,</span>
               <span class="n">step_size</span><span class="o">=</span><span class="mf">2000.</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;triangular&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">clr</span><span class="p">])</span>
</pre></div>
</div>
<p>Class also supports custom scaling functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clr_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">CyclicLR</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.006</span><span class="p">,</span>
               <span class="n">step_size</span><span class="o">=</span><span class="mf">2000.</span><span class="p">,</span> <span class="n">scale_fn</span><span class="o">=</span><span class="n">clr_fn</span><span class="p">,</span>
               <span class="n">scale_mode</span><span class="o">=</span><span class="s1">&#39;cycle&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">clr</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.CyclicLR.clr">
<span class="sig-name descname"><span class="pre">clr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CyclicLR.clr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CyclicLR.clr" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.CyclicLR.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CyclicLR.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CyclicLR.on_batch_end" title="Permalink to this definition">#</a></dt>
<dd><p>A backwards compatibility alias for <cite>on_train_batch_end</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.CyclicLR.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#CyclicLR.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.CyclicLR.on_train_begin" title="Permalink to this definition">#</a></dt>
<dd><p>Called at the beginning of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logs</strong> – dict. Currently no data is passed to this argument for this method
but that may change in the future.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.DataSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">DataSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#DataSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.DataSequence" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></p>
<p>Split data into batches for trainin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> – 2D Numpy array of tokenized SMILES of shape (number_of_SMILES, max_length)</p></li>
<li><p><strong>extra</strong> (<em>np.array</em>) – 2D Numpy array containing additional inputs of shape (number_of_SMILES, n_extra_features)</p></li>
<li><p><strong>props_set</strong> (<em>np.array</em>) – 1D Numpy array of target propertyof of shape (number_of_SMILES,)</p></li>
<li><p><strong>TODO</strong> (<em>check the exact shape</em><em>)</em>) – </p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A tuple containing a batch of input SMILES, extra data and property values.</em></p></li>
<li><p><em>The inputs (SMILES, extra) are of a dictionary shape in accordance with Keras format.</em></p></li>
<li><p><em>Examples</em> – {“smiles”: batch_smiles, “extra”: batch_extra}, batch_prop - when extra data is provided
{“smiles”: batch_smiles}, batch_prop - when no extra data is provided</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.DataSequence.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#DataSequence.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.DataSequence.on_epoch_end" title="Permalink to this definition">#</a></dt>
<dd><p>Method called at the end of every epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.IgnoreBeginningSaveBest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">IgnoreBeginningSaveBest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_first_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#IgnoreBeginningSaveBest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.IgnoreBeginningSaveBest" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Save the best weights only after some number of epochs has been trained</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Path to the directory where the model is saved.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Number of epochs requested for training.</p></li>
<li><p><strong>best_loss</strong> (<em>float</em>) – Best loss achieved so far. (Default: np.Inf)</p></li>
<li><p><strong>best_epoch</strong> (<em>int</em>) – Number of the epoch with lowest validation loss achieved so far. (Default: 0)</p></li>
<li><p><strong>initial_epoch</strong> (<em>int</em>) – The number of the initial epoch (needed for continuous training). (Default: 0)</p></li>
<li><p><strong>ignore_first_epochs</strong> (<em>int</em>) – How many epochs to ignore in the beginning of the training before to start
registering the best validation loss. (Default 0)</p></li>
<li><p><strong>last</strong> (<em>bool</em>) – In case of multi-step training, defines whether the last step is run.
Used for final printouts. (Default: False)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#IgnoreBeginningSaveBest.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end" title="Permalink to this definition">#</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – dict, metric results for this training epoch, and for the
validation epoch if validation is performed. Validation result keys
are prefixed with <cite>val_</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#IgnoreBeginningSaveBest.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end" title="Permalink to this definition">#</a></dt>
<dd><p>Called at the end of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logs</strong> – dict. Currently no data is passed to this argument for this method
but that may change in the future.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.LM_DataSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">LM_DataSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hash_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#LM_DataSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.LM_DataSequence" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></p>
<p>Data sequence to be fed to the neural network during training through batches of data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hash_set</strong> (<em>array</em><em> of </em><em>arrays</em><em> of </em><em>dimensions</em><em> (</em><em>3</em><em>, </em><em>number_of_SMILES</em><em>)</em>) – </p></li>
<li><p><strong>smiles_set</strong> (<em>array</em><em> of </em><em>padded with zeros integered tokenized SMILES</em><em> of </em><em>dimensions</em><em> (</em><em>number_of_SMILES</em><em>, </em><em>max_length</em><em>)</em>) – </p></li>
<li><p><strong>vocab_size</strong> (<em>size</em><em> of </em><em>the vocabulary</em>) – </p></li>
<li><p><strong>max_length</strong> (<em>maximum length</em><em> of </em><em>the SMILES</em>) – </p></li>
<li><p><strong>batch_size</strong> (<em>batch's size</em>) – </p></li>
<li><p><strong>training</strong> (<em>set up the training mode</em><em> (</em><em>Default: True</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>In training mode, returns</em> – a batch of arrays of tokenized and encoded SMILES,
a batch of SMILES property</p></li>
<li><p><em>else, returns</em> – a batch of arrays of tokenized and encoded SMILES alone</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.LM_DataSequence.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#LM_DataSequence.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.LM_DataSequence.on_epoch_end" title="Permalink to this definition">#</a></dt>
<dd><p>Method called at the end of every epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.LoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">LoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_fcn=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#LoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.LoggingCallback" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Implement custom logging class to continue logging during training</p>
<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.LoggingCallback.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#LoggingCallback.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.LoggingCallback.on_epoch_begin" title="Permalink to this definition">#</a></dt>
<dd><p>Called at the start of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – dict. Currently no data is passed to this argument for this method
but that may change in the future.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SMILESX.trainutils.LoggingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#LoggingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.LoggingCallback.on_epoch_end" title="Permalink to this definition">#</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – dict, metric results for this training epoch, and for the
validation epoch if validation is performed. Validation result keys
are prefixed with <cite>val_</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SMILESX.trainutils.StepDecay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">StepDecay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initAlpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finalAlpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#StepDecay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.StepDecay" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Step decay the learning rate during training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initAlpha</strong> (<em>float</em>) – Initial learning rate. (Default 1e-3)</p></li>
<li><p><strong>finalAlpha</strong> (<em>float</em>) – Final learning rate. (Default 1e-5)</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – NewAlpha = initAlpha * (gamma ** exp), where <cite>exp</cite> is determined
based on the desired number of epochs. (Default 0.95)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Desired number of epochs for training. (Default 100)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.trainutils.seq_trunc">
<span class="sig-prename descclassname"><span class="pre">SMILESX.trainutils.</span></span><span class="sig-name descname"><span class="pre">seq_trunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hash_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocab_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/trainutils.html#seq_trunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.trainutils.seq_trunc" title="Permalink to this definition">#</a></dt>
<dd><p>To sequentially produce truncated SMILES of one token</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hash_set</strong> (<em>array</em><em> of </em><em>arrays</em><em> of </em><em>dimensions</em><em> (</em><em>3</em><em>, </em><em>number_of_SMILES</em><em>)</em>) – </p></li>
<li><p><strong>smiles_set</strong> (<em>array</em><em> of </em><em>padded with zeros integered tokenized SMILES</em><em> of </em><em>dimensions</em><em> (</em><em>number_of_SMILES</em><em>, </em><em>max_length</em><em>)</em>) – </p></li>
<li><p><strong>max_length</strong> (<em>maximum length</em><em> of </em><em>the SMILES</em>) – </p></li>
<li><p><strong>vocab_size</strong> (<em>size</em><em> of </em><em>the vocabulary</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Truncated SMILES</p></li>
<li><p>One-hot vectored truncated token</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Two arrays</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.utils">
<span id="smilesx-utils-module"></span><h2>SMILESX.utils module<a class="headerlink" href="#module-SMILESX.utils" title="Permalink to this heading">#</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="SMILESX.utils.StopExecution">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">StopExecution</span></span><a class="reference internal" href="_modules/SMILESX/utils.html#StopExecution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.StopExecution" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Clean execution termination (no warnings).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.log_setup">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">log_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#log_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.log_setup" title="Permalink to this definition">#</a></dt>
<dd><p>Setting up the logging format and files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> (<em>str</em>) – The directory where the logfile will be saved.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the operation (train, inference, interpretation).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether of now to printout the logs into console.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>logger</strong> (<em>logger</em>) – Logger instance.</p></li>
<li><p><strong>logfile</strong> (<em>str</em>) – File to save the logs to.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.mean_result">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">mean_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_enum_card</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_enum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#mean_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.mean_result" title="Permalink to this definition">#</a></dt>
<dd><p>Compute mean and median of predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_enum_card</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – List of indices that are the same for the augmented SMILES originating from the same original SMILES</p></li>
<li><p><strong>preds_enum</strong> (<em>np.array</em>) – Predictions for every augmented SMILES for every predictive model</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the predictive model (‘regression’, ‘binary_classification’, ‘multiclass_classification’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>preds_mean</strong> (<em>float</em>) – Mean over predictions augmentations and models</p></li>
<li><p><strong>preds_std</strong> (<em>float</em>) – Standard deviation over predictions augmentations and models</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.rand_split">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">rand_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_val_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bayopt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#rand_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.rand_split" title="Permalink to this definition">#</a></dt>
<dd><p>Splits into train, valid, test sets, and standardizes the target property (mean 0, std 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_input</strong> (<em>np.array</em>) – Numpy array of SMILES.</p></li>
<li><p><strong>prop_input</strong> (<em>np.array</em>) – Numpy array of property to split.</p></li>
<li><p><strong>extra_input</strong> (<em>np.array</em>) – Numpy array of additional input data to split.</p></li>
<li><p><strong>err_input</strong> (<em>np.array</em>) – Numpy array of property error to split.</p></li>
<li><p><strong>train_val_idx</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Indices of the data to be used for training and validation returned by KFold.</p></li>
<li><p><strong>valid_test_index</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – Indices of the data to be used for testing returned by KFold.</p></li>
<li><p><strong>bayopt</strong> (<em>bool</em>) – Whether or not Bayesian optimization is used. If True, a test set isn’t returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_train</strong> (<em>np.array</em>) – SMILES np.array for training.</p></li>
<li><p><strong>x_valid</strong> (<em>np.array</em>) – SMILES np.array for validation.</p></li>
<li><p><strong>x_test</strong> (<em>np.array</em>) – SMILES np.array for test.</p></li>
<li><p><strong>extra_train</strong> (<em>np.array</em>) – np.array of additional input data for training.</p></li>
<li><p><strong>extra_valid</strong> (<em>np.array</em>) – np.array of additional input data for validation.</p></li>
<li><p><strong>extra_test</strong> (<em>np.array</em>) – np.array of additional input data for test.</p></li>
<li><p><strong>y_train</strong> (<em>np.array</em>) – np.array of output data for training.</p></li>
<li><p><strong>y_valid</strong> (<em>np.array</em>) – np.array of output data for validation.</p></li>
<li><p><strong>y_test</strong> (<em>np.array</em>) – np.array of output data for test.</p></li>
<li><p><strong>err_train</strong> (<em>np.array</em>) – np.array of errors on output data for training.</p></li>
<li><p><strong>err_valid</strong> (<em>np.array</em>) – np.array of errors on output data for validation.</p></li>
<li><p><strong>err_test</strong> (<em>np.array</em>) – np.array of errors on output data for training.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.robust_scaler">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">robust_scaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#robust_scaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.robust_scaler" title="Permalink to this definition">#</a></dt>
<dd><p>Scale the output data and optionally saves scalers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>np.array</em>) – Train set output property or extra input values.</p></li>
<li><p><strong>valid</strong> (<em>np.array</em>) – Validation set output property or extra input values.</p></li>
<li><p><strong>test</strong> (<em>np.array</em>) – Test set output property or extra input values.</p></li>
<li><p><strong>save_dir</strong> (<em>str</em>) – Path to the directory where the scalers should be saved (if <a href="#id1"><span class="problematic" id="id2">`</span></a>save`=True).</p></li>
<li><p><strong>data_name</strong> (<em>str</em>) – Data name (used for naming).</p></li>
<li><p><strong>ifold</strong> (<em>int</em>) – Current k-fold cross-validation fold index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>train_scaled</strong> (<em>np.array</em>) – Scaled train set output property or extra input values.</p></li>
<li><p><strong>valid_scaled</strong> (<em>np.array</em>) – Scaled validation set output property or extra input values.</p></li>
<li><p><strong>test_scaled</strong> (<em>np.array</em>) – Scaled test set output property or extra input values.</p></li>
<li><p><strong>scaler</strong> (<em>sklearn.preprocessing.RobustScaler object</em>) – Scaler to be used during the prediciton phase to unscale the outputs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.set_gpuoptions">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">set_gpuoptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_gpus=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_list=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus_debug=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_fn=&lt;function</span> <span class="pre">info&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#set_gpuoptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.set_gpuoptions" title="Permalink to this definition">#</a></dt>
<dd><p>Setup GPU usage and memory growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngpus</strong> (<em>int</em>) – Number of GPUs to be used.
(Default: 1)</p></li>
<li><p><strong>gpus_list</strong> (<em>list</em><em>, </em><em>optional</em>) – List of GPU IDs to be used, e.g. [0, 1, 2]. If <cite>gpus_list</cite> and <cite>ngpus</cite>
are both provided, <cite>gpus_list</cite> prevails.
(Default: None)</p></li>
<li><p><strong>gpus_debug</strong> (<em>bool</em>) – Print out the GPUs ongoing usage.
(Default: False)</p></li>
<li><p><strong>print_fn</strong> (<em>{logging.info</em><em>, </em><em>print}</em>) – Print out function. Either logging.info or print options are accepted.
(Default: logging.info)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>strategy</em> – Memory growth strategy.</p></li>
<li><p><strong>logical_gpus</strong> (<em>list</em>) – List of logical GPUs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.utils.smiles_concat">
<span class="sig-prename descclassname"><span class="pre">SMILESX.utils.</span></span><span class="sig-name descname"><span class="pre">smiles_concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/utils.html#smiles_concat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.utils.smiles_concat" title="Permalink to this definition">#</a></dt>
<dd><p>Concatenate multiple SMILES in one via ‘j’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>smiles_list</strong> (<em>array</em>) – Array of SMILES to be concatenated along axis=0 to form a single SMILES.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of concatenated SMILES, one per data point.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>concat_smiles_list</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-SMILESX.visutils">
<span id="smilesx-visutils-module"></span><h2>SMILESX.visutils module<a class="headerlink" href="#module-SMILESX.visutils" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.classification_metrics">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">classification_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#classification_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.classification_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Computes precision, recall, F1, support, ROC AUC and PR AUC scores for
classification tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>list</em>) – List of true values.</p></li>
<li><p><strong>y_pred</strong> (<em>list</em>) – List of predicted values.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the model to be used. Can be either ‘regression’, ‘binary_classification’, or ‘multi_classification’. (Default: ‘regression’)</p></li>
<li><p><strong>prec</strong> (<em>int</em>) – Printing precision. (Default: 4)</p></li>
<li><p><strong>average</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of averaging performed on the data. If None, no averaging is
performed. (Default: None)</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>) – List of labels for classification tasks. (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>precision</strong> (<em>float</em>) – Precision score.</p></li>
<li><p><strong>recall</strong> (<em>float</em>) – Recall score.</p></li>
<li><p><strong>f1_score</strong> (<em>float</em>) – F1 score.</p></li>
<li><p><strong>support</strong> (<em>int</em>) – Support.</p></li>
<li><p><strong>precision_prec</strong> (<em>float</em>) – Precision score with printing precision.</p></li>
<li><p><strong>recall_prec</strong> (<em>float</em>) – Recall score with printing precision.</p></li>
<li><p><strong>f1_score_prec</strong> (<em>float</em>) – F1 score with printing precision.</p></li>
<li><p><strong>roc_auc</strong> (<em>float</em>) – ROC AUC score.</p></li>
<li><p><strong>prc_auc</strong> (<em>float</em>) – PR AUC score.</p></li>
<li><p><strong>roc_auc_prec</strong> (<em>float</em>) – ROC AUC score with printing precision.</p></li>
<li><p><strong>prc_auc_prec</strong> (<em>float</em>) – PR AUC score with printing precision.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.error_format">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">error_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#error_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.error_format" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.learning_curve">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">learning_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ifold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/SMILESX/visutils.html#learning_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.learning_curve" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.lm_metric_curve">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">lm_metric_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imetrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imetrics_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/SMILESX/visutils.html#lm_metric_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.lm_metric_curve" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.output_prec">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">output_prec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#output_prec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.output_prec" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.plot_fit">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">plot_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_bars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dlabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/SMILESX/visutils.html#plot_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.plot_fit" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true</strong> (<em>list</em>) – List of true values.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – List of predicted values.</p></li>
<li><p><strong>errs_true</strong> (<em>list array</em>) – List or array of errors associated with the true values ([min, max] array
or standard deviation list).</p></li>
<li><p><strong>errs_pred</strong> (<em>list</em>) – List of errors associated with the predicted values (standard deviations
computed over augmentations and/or runs).</p></li>
<li><p><strong>err_bars</strong> (<em>{'minmax'</em><em>,</em><em>'std'}</em><em>, </em><em>optional</em>) – Format for the error bars to be printed (symmetric for standard deviation,
assymetric for [min, max] range).</p></li>
<li><p><strong>save_dir</strong> (<em>str</em>) – Directory to store the plots into.</p></li>
<li><p><strong>dname</strong> (<em>str</em>) – Dataset name.</p></li>
<li><p><strong>dlabel</strong> (<em>str</em>) – Dataset label used for plot titles.</p></li>
<li><p><strong>units</strong> (<em>str</em>) – Data units used for plot titles.</p></li>
<li><p><strong>fold</strong> (<em>int</em><em>, </em><em>optional</em>) – Cross-validation fold index.</p></li>
<li><p><strong>run</strong> (<em>int</em><em>, </em><em>optional</em>) – Run index.</p></li>
<li><p><strong>final</strong> (<em>bool</em>) – Whether the plot is built for the final out-of-sample predictions.</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the model to be used. Can be either ‘regression’, ‘binary_classification’, or ‘multi_classification’. (Default: ‘regression’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.print_stats">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">print_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#print_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.print_stats" title="Permalink to this definition">#</a></dt>
<dd><p>Computes, prints and returns RMSE, MAE and R2 for the predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trues</strong> (<em>list</em>) – List of train, validation and test true values.</p></li>
<li><p><strong>preds</strong> (<em>list</em>) – List of train, validation and test predicted values.</p></li>
<li><p><strong>errs_pred</strong> (<em>list</em><em>, </em><em>optional</em>) – List of train, validation and test errors associated with the
predictions. (Default: None)</p></li>
<li><p><strong>prec</strong> (<em>int</em>) – Printing precision. (Default: 4)</p></li>
<li><p><strong>model_type</strong> (<em>str</em>) – Type of the model to be used. Can be either ‘regression’, ‘binary_classification’, or ‘multi_classification’. (Default: ‘regression’)</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>) – List of labels for classification tasks. (Default: None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>Optionally returns the following values</em></p></li>
<li><p><em>For regression tasks</em> –</p>
<dl class="simple">
<dt>rmse_str: str</dt><dd><p>Root mean square error (RMSE) together with error obtained via
error propagation based on the input prediction errors.</p>
</dd>
<dt>mae_str: float</dt><dd><p>Mean absolute error (MAE) together with error obtained via
error propagation based on the input prediction errors.</p>
</dd>
<dt>r2_str: float</dt><dd><p>R2 correlation score together with error obtained via
error propagation based on the input prediction errors.</p>
</dd>
</dl>
</li>
<li><p><em>For classification tasks</em> –</p>
<dl class="simple">
<dt>acc_str: str</dt><dd><p>Accuracy score.</p>
</dd>
<dt>prec_str: str</dt><dd><p>Precision score.</p>
</dd>
<dt>recell_str: str</dt><dd><p>Recall score.</p>
</dd>
<dt>f1_str: str</dt><dd><p>F1 score.</p>
</dd>
<dt>prp_auc_str: str</dt><dd><p>Area under the precision-recall curve. More fitted to imbalanced data than ROC AUC.</p>
</dd>
<dt>conf_mat_arr: 2D numpy array</dt><dd><p>Confusion matrix.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.sigma_classification_metrics">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">sigma_classification_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_mc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#sigma_classification_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.sigma_classification_metrics" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.sigma_mae">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">sigma_mae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#sigma_mae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.sigma_mae" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.sigma_r2">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">sigma_r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#sigma_r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.sigma_r2" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SMILESX.visutils.sigma_rmse">
<span class="sig-prename descclassname"><span class="pre">SMILESX.visutils.</span></span><span class="sig-name descname"><span class="pre">sigma_rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SMILESX/visutils.html#sigma_rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#SMILESX.visutils.sigma_rmse" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-SMILESX">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-SMILESX" title="Permalink to this heading">#</a></h2>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SMILESX</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.augm">SMILESX.augm module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.augmentation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.generate_smiles"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.generate_smiles()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.augm.rotate_atoms"><code class="docutils literal notranslate"><span class="pre">SMILESX.augm.rotate_atoms()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.bayopt">SMILESX.bayopt module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.bayopt.bayopt_run"><code class="docutils literal notranslate"><span class="pre">SMILESX.bayopt.bayopt_run()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.embeddingvis">SMILESX.embeddingvis module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.embeddingvis.Embedding_Vis"><code class="docutils literal notranslate"><span class="pre">SMILESX.embeddingvis.Embedding_Vis()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.generation">SMILESX.generation module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.data_name"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.data_name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.g_run_number"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.g_run_number</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gen_augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gen_augmentation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_augmentation"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_augmentation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_use_n_folds"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_use_n_folds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.infer_use_n_runs"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.infer_use_n_runs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.indir"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.indir</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.outdir"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.outdir</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.n_gpus"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.n_gpus</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gpus_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gpus_list</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.gpus_debug"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.gpus_debug</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.prop_names_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.prop_names_list</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.display"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.display()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generation.Generation.generate"><code class="docutils literal notranslate"><span class="pre">SMILESX.generation.Generation.generate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.generative_main">SMILESX.generative_main module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.generative_main.generative_main"><code class="docutils literal notranslate"><span class="pre">SMILESX.generative_main.generative_main()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.genutils">SMILESX.genutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.join_tokens"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.join_tokens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.normalize"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.normalize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.p_to_one"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.p_to_one()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.remove_from_list"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.remove_from_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.remove_schar"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.remove_schar()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.sample"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.sample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.softmax"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.softmax()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.genutils.t_cdf"><code class="docutils literal notranslate"><span class="pre">SMILESX.genutils.t_cdf()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.geomopt">SMILESX.geomopt module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_prescore"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_prescore()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_score"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.geomopt.geom_search"><code class="docutils literal notranslate"><span class="pre">SMILESX.geomopt.geom_search()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.inference">SMILESX.inference module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.inference.infer"><code class="docutils literal notranslate"><span class="pre">SMILESX.inference.infer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.interpret">SMILESX.interpret module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.interpret.get_similarity_map_from_weights"><code class="docutils literal notranslate"><span class="pre">SMILESX.interpret.get_similarity_map_from_weights()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.interpret.interpret"><code class="docutils literal notranslate"><span class="pre">SMILESX.interpret.interpret()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.loadmodel">SMILESX.loadmodel module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.loadmodel.LoadModel"><code class="docutils literal notranslate"><span class="pre">SMILESX.loadmodel.LoadModel</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.main">SMILESX.main module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.main.main"><code class="docutils literal notranslate"><span class="pre">SMILESX.main.main()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.model">SMILESX.model module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.LSTMAttModel"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.LSTMAttModel</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.LSTMAttModel.create"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.LSTMAttModel.create()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.build"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.build()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.call"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.call()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.compute_output_shape"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.compute_output_shape()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.create_masks"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.create_masks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.create_padding_mask"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.create_padding_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.model.SoftAttention.get_config"><code class="docutils literal notranslate"><span class="pre">SMILESX.model.SoftAttention.get_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.token">SMILESX.token module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.extract_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.extract_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_inttotoken"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_inttotoken()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_tokens"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_tokens()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_tokentoint"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_tokentoint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.get_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.get_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.int_vec_encode"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.int_vec_encode()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.onehot"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.onehot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.save_vocab"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.save_vocab()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.token.smiles_tokenizer"><code class="docutils literal notranslate"><span class="pre">SMILESX.token.smiles_tokenizer()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.trainutils">SMILESX.trainutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CosineAnneal"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CosineAnneal</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN.evaluation"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN.evaluation()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CxUxN.on_evaluation_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CxUxN.on_evaluation_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.clr"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.clr()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.on_batch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.on_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.CyclicLR.on_train_begin"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.CyclicLR.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.DataSequence"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.DataSequence</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.DataSequence.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.DataSequence.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest.on_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.IgnoreBeginningSaveBest.on_train_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LM_DataSequence"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LM_DataSequence</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LM_DataSequence.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LM_DataSequence.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback.on_epoch_begin()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.LoggingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.LoggingCallback.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.StepDecay"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.StepDecay</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.trainutils.seq_trunc"><code class="docutils literal notranslate"><span class="pre">SMILESX.trainutils.seq_trunc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.utils">SMILESX.utils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.StopExecution"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.StopExecution</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.log_setup"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.log_setup()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.mean_result"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.mean_result()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.rand_split"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.rand_split()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.robust_scaler"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.robust_scaler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.set_gpuoptions"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.set_gpuoptions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.utils.smiles_concat"><code class="docutils literal notranslate"><span class="pre">SMILESX.utils.smiles_concat()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX.visutils">SMILESX.visutils module</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.classification_metrics"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.classification_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.error_format"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.error_format()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.learning_curve"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.learning_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.lm_metric_curve"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.lm_metric_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.output_prec"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.output_prec()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.plot_fit"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.plot_fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.print_stats"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.print_stats()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_classification_metrics"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_classification_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_mae"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_mae()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_r2"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_r2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#SMILESX.visutils.sigma_rmse"><code class="docutils literal notranslate"><span class="pre">SMILESX.visutils.sigma_rmse()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-SMILESX">Module contents</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Guillaume Lambard, Ekaterina Gracheva
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023, Guillaume Lambard, Ekaterina Gracheva.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>